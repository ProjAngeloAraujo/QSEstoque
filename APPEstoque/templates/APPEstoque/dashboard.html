{% load static %}

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Controle de Estoque</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'APPEstoque/CSS/dashboard.css' %}">
</head>
<body>
    {% if error %}
        <p style="color: red; text-align: center;">{{ error }}</p>
    {% endif %}
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1>ðŸ“¦ Controle de Estoque</h1>
            <div class="header-actions">
                <div class="user-info">
                    <div class="user-avatar">{{ usuario_nome|first|upper }}</div>
                    <span>{{ usuario_nome }}</span>
                </div>
                <a href="{% url 'logout_user' %}" class="btn-logout">Sair</a>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <main class="main-container">
        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <div>
                        <div class="stat-value">{{ total_containers }}</div>
                        <div class="stat-label">Total de Containers</div>
                    </div>
                    <div class="stat-icon green">ðŸ“¦</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <div>
                        <div class="stat-value">{{ total_produtos }}</div>
                        <div class="stat-label">Total de Produtos</div>
                    </div>
                    <div class="stat-icon brown">ðŸ“Š</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <div>
                        <div class="stat-value">{{ pedidos_pendentes }}</div>
                        <div class="stat-label">Pedidos Pendentes</div>
                    </div>
                    <div class="stat-icon gold">ðŸ””</div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <div>
                        <div class="stat-value">{{ containers_ativos }}</div>
                        <div class="stat-label">Containers Ativos</div>
                    </div>
                    <div class="stat-icon green">âœ“</div>
                </div>
            </div>
        </div>

        <!-- Containers Section -->
        <div class="section-header">
            <h2>Containers de Estoque</h2>
            <button class="btn-add">+ Novo Container</button>
        </div>

        <div class="containers-grid">
            {% for container in containers %}
            <div class="container-card">
                <div class="container-header">
                    <div class="container-title">{{ container.nome_container }}</div>
                    <div class="container-id">#CNT-{{ container.id_container }}</div>
                </div>
                <div class="container-body">
                    <ul class="product-list">
                        {% for produto in container.produtos.all %}
                        <li class="product-item">
                            <div class="product-info">
                                <div class="product-name">{{ produto.nome_produto }}</div>
                                <div class="product-category">
                                    {{ produto.gramagem_produto|upper }} - 
                                    {% if produto.status_produto == 'frito_congelado' %}
                                        Frito e Congelado
                                    {% else %}
                                        Cru e Congelado
                                    {% endif %}
                                </div>
                            </div>
                            <div class="product-quantity">{{ produto.quantidade_produto }} un</div>
                        </li>
                        {% empty %}
                        <li class="product-item">
                            <em>Nenhum produto neste container</em>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="container-footer">
                    <span class="container-status {{ container.status }}">{{ container.status|capfirst }}</span>
                    <a href="#" class="btn-view" style="text-decoration: none; display: inline-block;">Ver Detalhes</a>
                </div>
            </div>
            {% empty %}
            <p style="text-align:center;">Nenhum container cadastrado</p>
            {% endfor %}
        </div>

        <!-- Orders Section -->
        <div class="section-header">
            <h2>Pedidos Recentes</h2>
        </div>

        <div class="orders-section">
            <table class="orders-table">
                <thead>
                    <tr>
                        <th>NÃºmero do Pedido</th>
                        <th>Nome do Cliente</th>
                        <th>RegiÃ£o</th>
                        <th>Falta</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pedido in pedidos %}
                    <tr>
                        <td>#{{ pedido.numero_cliente_pedido }}</td>
                        <td>{{ pedido.nome_cliente_pedido }}</td>
                        <td>{{ pedido.regiao_pedido }}</td>
                        <td>
                            {% if pedido.falta == 'sim' %}
                                <span class="order-status pending">Sim</span>
                            {% else %}
                                <span class="order-status completed">NÃ£o</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if pedido.status_pedido == 'entregue' %}
                                <span class="order-status entregue">Entregue</span>
                            {% elif pedido.status_pedido == 'separado' %}
                                <span class="order-status separado">Separado</span>
                            {% else %}
                                <span class="order-status separar">Separar</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="5" style="text-align:center;">Nenhum pedido encontrado</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </main>
</body>
</html>